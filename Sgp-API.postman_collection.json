{
	"info": {
		"_postman_id": "74f2be2b-b10a-4a6b-a4da-5e70ecd558d8",
		"name": "Sgp API",
		"description": "-Endpoints para acceder a la base de datos",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Login",
			"item": [
				{
					"name": "Tests Login",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.sendRequest({",
									"    url: 'localhost:3000/api/login',",
									"    method: 'POST',",
									"    header: {",
									"        'content-type': 'application/json'",
									"    },",
									"    body: {",
									"        mode:'raw',",
									"        raw: JSON.stringify({",
									"            \"email\": \"emailFallo@gmail.com\",",
									"            \"password\": \"aaaaa\"",
									"        })",
									"    }",
									"}, (err, res) => {",
									"    pm.test(\"Email no encontrado status\", function() {",
									"        pm.expect(res).to.have.status(404)",
									"    })",
									"",
									"    pm.test(\"Email no encontrado body\", function(){",
									"        const resP= res.json()",
									"        pm.expect(resP.response).to.eql(\"usuario no encontrado\")",
									"    })",
									"})",
									"",
									"pm.sendRequest({",
									"    url: 'localhost:3000/api/login',",
									"    method: 'POST',",
									"    header: {",
									"        'content-type': 'application/json'",
									"    },",
									"    body: {",
									"        mode:'raw',",
									"        raw: JSON.stringify({",
									"            \"email\": \"a@gmail.com\",",
									"            \"password\": \"aaaaa\"",
									"        })",
									"    }",
									"}, (err, res) => {",
									"    pm.test(\"Test Response status 200 para un usuario existente\", function(){",
									"        pm.expect(res).to.have.status(200)",
									"    })",
									"    ",
									"    pm.test(\"Test Response usuario logueado para un usuario existente\", function(){",
									"        const resP= res.json()",
									"        pm.expect(resP.response).to.eql(\"usuario logueado\")",
									"    })  ",
									"})",
									"",
									"pm.sendRequest({",
									"    url: 'localhost:3000/api/login',",
									"    method: 'POST',",
									"    header: {",
									"        'content-type': 'application/json'",
									"    },",
									"    body: {",
									"        mode:'raw',",
									"        raw: JSON.stringify({",
									"            \"emai\": \"a@gmail.com\",",
									"            \"password\": \"aaaaa\"",
									"        })",
									"    }",
									"}, (err, res) => {",
									"    pm.test(\"Test Response status 400 para un usuario existente, pero con error de campos\", function(){",
									"        pm.expect(res).to.have.status(404)",
									"    })",
									"    ",
									"    pm.test(\"Test Response usuario logueado para un usuario existente, pero con error de campos\", function(){",
									"        const resP= res.json()",
									"        pm.expect(resP.response).to.eql('Revisar campos y/o sus datos')",
									"    })  ",
									"})",
									"",
									""
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"protocolProfileBehavior": {
						"disabledSystemHeaders": {}
					},
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"email\": \"a@gmail.com\",\n    \"password\": \"aaaa\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "localhost:3000/api/login",
							"host": [
								"localhost"
							],
							"port": "3000",
							"path": [
								"api",
								"login"
							]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "Register",
			"item": [
				{
					"name": "Tests Register",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Usuario registrado exitosamente con status 200\", function() {",
									"    pm.response.to.have.status(200)",
									"})",
									"",
									"pm.test(\"Usuario registrado exitosamente con response de exito\", function() {",
									"    const res = pm.response.json()",
									"    pm.expect(res.response).to.eql(\"Usuario registrado con exito\")",
									"})",
									"",
									"pm.sendRequest({",
									"    url: 'localhost:3000/api/register',",
									"    method: 'POST',",
									"    header: {",
									"        'content-type': 'application/json'",
									"    },",
									"    body: {",
									"        mode:'raw',",
									"        raw: JSON.stringify({",
									"            \"name\": \"userPrueba\",",
									"            \"email\": \"a@gmail.com\",",
									"            \"password\": \"userPrueba\"",
									"        })",
									"    }",
									"}, (err, res) => {",
									"   pm.test(\"Usuario intenta registrarse, con email ya usado y recibe status 400\", function() {",
									"        pm.expect(res).to.have.status(400)",
									"    })",
									"",
									"    pm.test(\"Usuario intenta registrarse, con email ya registrado. Recibe response de email ya utilizado\", function() {",
									"        const resP = res.json()",
									"        pm.expect(resP.response).to.eql(\"Usuario ya creado para este email\")",
									"    })",
									"})",
									"",
									"pm.sendRequest({",
									"    url: 'localhost:3000/api/register',",
									"    method: 'POST',",
									"    header: {",
									"        'content-type': 'application/json'",
									"    },",
									"    body: {",
									"        mode:'raw',",
									"        raw: JSON.stringify({",
									"            \"name\": \"userPrueba\",",
									"            \"emai\": \"mailParaPersonaNueva@gmail.com\",",
									"            \"passwor\": \"userPrueba\"",
									"        })",
									"    }",
									"}, (err, res) => {",
									"   pm.test(\"intento de registrar usuario nuevo y recibe response status 404\", function() {",
									"        pm.expect(res).to.have.status(404)",
									"    })",
									"",
									"    pm.test(\"intento de registrar usuario nuevo pero con errores de campos(bad request)\", function() {",
									"        const resP = res.json()",
									"        pm.expect(resP.response).to.eql('Revisar campos y/o sus datos')",
									"    })",
									"})",
									"",
									"",
									"pm.test(\"Borrar usuario justo despues de crearse\", function() {",
									"    const res = pm.response.json()",
									"",
									"    pm.sendRequest({",
									"    url: `localhost:3000/api/delete/${res.user._id}`,",
									"    method: 'PUT',",
									"    header: {",
									"        'content-type': 'application/json'",
									"    },",
									"    body: {",
									"    }",
									"}, (err, res) => {",
									"   pm.test(\"Se borra usuario recien creado con exito\", function() {",
									"        pm.expect(res).to.have.status(200)",
									"    })",
									"",
									"    pm.test(\"Se borra usuario post creacion y se checkea response\", function() {",
									"        const resP = res.json()",
									"        pm.expect(resP.response).to.eql('Usuario eliminado correctamente!')",
									"    })",
									"})",
									"})",
									""
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"name\": \"userPrueba\",\n    \"email\": \"a2@gmail.com\",\n    \"password\": \"userPrueba\"\n}",
							"options": {
								"raw": {
									"language": "json"
								}
							}
						},
						"url": {
							"raw": "localhost:3000/api/register",
							"host": [
								"localhost"
							],
							"port": "3000",
							"path": [
								"api",
								"register"
							]
						},
						"description": "Registro exitoso de usuario"
					},
					"response": []
				}
			]
		},
		{
			"name": "Users",
			"item": [
				{
					"name": "Test Get User",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									""
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Usuario encontrado exitosamente con status 200\", function() {",
									"    pm.response.to.have.status(200)",
									"})",
									"",
									"pm.test(\"Response 'Usuario encontrado' \", function() {",
									"    const res = pm.response.json();",
									"    pm.expect(res.response).to.eql('Usuario encontrado') ",
									"})",
									"",
									"",
									"pm.sendRequest({",
									"    url: 'localhost:3000/api/users/614f9117cd2f4a0f81ca23f',",
									"    method: 'GET',",
									"    header: {",
									"        'content-type': 'application/json'",
									"    },",
									"    body: {",
									"    }",
									"}, (err, res) => {",
									"    pm.test(\"Usuario no encontrado response status 404\", function() {",
									"        pm.expect(res).to.have.status(404)",
									"    })",
									"})"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "http://localhost:3000/api/users/614f9117cd2f4a0f81ca23fa",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "3000",
							"path": [
								"api",
								"users",
								"614f9117cd2f4a0f81ca23fa"
							]
						},
						"description": "Devuelve el usuario con sus datos para el id pasado por parametro"
					},
					"response": []
				},
				{
					"name": "Test Get All Users",
					"event": [
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									""
								],
								"type": "text/javascript"
							}
						},
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"Usuarios encontrados exitosamente con status 200\", function() {",
									"    pm.response.to.have.status(200)",
									"})",
									"",
									"pm.test(\"Usuarios encontrados exitosamente\", function() {",
									"    const res = pm.response.json();",
									"    const isArray = Array.isArray(res.response);",
									"    pm.expect(isArray).to.eql(Array.isArray([])) ",
									"})"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "http://localhost:3000/api/users",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "3000",
							"path": [
								"api",
								"users"
							]
						},
						"description": "Devuelve todos los usuarios de la base de datos"
					},
					"response": []
				}
			]
		}
	]
}